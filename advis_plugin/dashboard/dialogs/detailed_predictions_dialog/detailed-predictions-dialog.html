<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../tf-backend/tf-backend.html">

<link rel="import" href="../../paper-dialog/paper-dialog.html">
<link rel="import" href="../../paper-button/paper-button.html">
<link rel="import" href="../../paper-spinner/paper-spinner.html">

<link rel="import" href="../../constants/constants.html">
<link rel="import" href="../../dialog-header/dialog-header.html">
<link rel="import" href="../../dialog-behavior/dialog-behavior.html">
<link rel="import" href="../../section-header/section-header.html">
<link rel="import" href="../../image-loader/image-loader.html">
<link rel="import" href="../../prediction-category/prediction-category.html">

<!--
	When opened, this module displays a dialog with a list of the predictions of 
	a model on an input image and on its distorted versions.
-->
<dom-module id="detailed-predictions-dialog">
	<template>
		<paper-dialog with-backdrop>
			<dialog-header event-id="detailed-predictions-dialog">
				<div class="header-items">
					<h2>Predictions</h2>
				</div>
			</dialog-header>
			<div id="content">
				<div id="sides">
					<div class="side">
						<section-header text="Original"></section-header>
						<div id="original-image-container">
							<image-loader
								url=[[_originalImageUrl]]
								width="300px"
								height="300px">
							</image-loader>
						</div>
						<div class="predictions">
							<div class="spinner-container">
								<paper-spinner-lite active
									class$="[[_getSpinnerClass(_loadingOriginalPredictions)]]">
								</paper-spinner-lite>
							</div>
							<template is="dom-repeat"
								items="[[_sliceArray(_originalPredictions, _predictionAmount)]]">
								<prediction-category
									name=[[item.categoryName]]
									value=[[item.certainty]]>
								</prediction-category>
							</template>
						</div>
					</div>
					<div class="side">
						<section-header text="Average Distorted"></section-header>
						<div id="distorted-image-container">
							<template is="dom-if" if="[[!_singlePreviewImage]]">
								<template is="dom-repeat" items="[[_distortedImageUrls]]">
									<image-loader
										class$="image-grid image-grid-[[index]]"
										url=[[item]]
										width="147px"
										height="147px">
									</image-loader>
								</template>
							</template>
							<template is="dom-if" if="[[_singlePreviewImage]]">
								<image-loader
									class="single-image"
									url=[[_distortedImageUrls.0]]
									width="300px"
									height="300px">
								</image-loader>
							</template>
						</div>
						<div class="predictions">
							<div class="spinner-container">
								<paper-spinner-lite active
									class$="[[_getSpinnerClass(_loadingDistortedPredictions)]]">
								</paper-spinner-lite>
							</div>
							<template is="dom-repeat"
								items="[[_sliceArray(_distortedPredictions, _predictionAmount)]]">
								<prediction-category
									name=[[item.categoryName]]
									value=[[item.certainty]]>
								</prediction-category>
							</template>
						</div>
					</div>
				</div>
				<div id="bottom">
					<paper-button id="load-more-predictions-button"
						disabled="[[_loadMoreButtonDisabled(_originalPredictions, _predictionAmount, _loadingOriginalPredictions, _loadingDistortedPredictions)]]"
						on-tap="loadMorePredictions">
						<p>Load more predictions</p>
					</paper-button>
				</div>
			</div>
		</paper-dialog>
		
		<link rel="stylesheet" type="text/css" href="detailed-predictions-dialog.css">
	</template>

	<script src="detailed-predictions-dialog.js"></script>
</dom-module>
